var e;function t(n){const{type:r}=n;switch(r){case e.TEXT:!function(e){const{domElement:t}=e;t&&t.remove()}(n);break;case e.ELEMENT:!function(e){const{domElement:n,children:r,listeners:s}=e;if(!n)return;n.remove(),r.forEach(t),s&&(!function(e={},t){Object.entries(e).forEach(([e,n])=>{t.removeEventListener(e,n)})}(s,n),delete e.listeners)}(n);break;case e.FRAGMENT:!function(e){const{children:n}=e;n.forEach(t)}(n);break;default:throw new Error("Cannot destroy DOM of type: ",r)}delete n.domElement}!function(e){e.TEXT="text",e.ELEMENT="element",e.FRAGMENT="fragment"}(e||(e={}));class n{#e=new Map;#t=[];subscribe(e,t){this.#e.has(e)||this.#e.set(e,[]);const n=this.#e.get(e);return n?.includes(t)?()=>{}:(n?.push(t),()=>{if(n){const e=n?.indexOf(t);n?.splice(e,1)}})}afterEveryCommand(e){return this.#t.push(e),()=>{const t=this.#t.indexOf(e);this.#t.splice(t,1)}}dispatch(e,t){this.#e.has(e)?this.#e.get(e)?.forEach(e=>e(t)):console.warn(`No handlers found for command: ${e}`),this.#t.forEach(e=>e())}}function r(e,t){const{class:n,style:r,...o}=t;("string"==typeof n||Array.isArray(n))&&function(e,t){e.className="","string"==typeof t&&(e.className=t);Array.isArray(t)&&e.classList.add(...t)}(e,n),r&&Object.entries(r).forEach(([t,n])=>{"string"==typeof n&&function(e,t,n){e.style[t]=n}(e,t,n)});for(const[t,n]of Object.entries(o))"string"==typeof n&&s(e,t,n)}function s(e,t,n){null==n?function(e,t){e[t]=null,e.removeAttribute(t)}(e,t):t.startsWith("data-")?e.setAttribute(t,n):e[t]=n}function o(t,n){if(null==n)throw new Error(`\n      "Parent element is not defined: ${n}`);switch(t.type){case e.TEXT:!function(e,t){const{value:n}=e,r=document.createTextNode(n);e.domElement=r,t.appendChild(r)}(t,n);break;case e.ELEMENT:!function(e,t){const{tag:n,props:s,children:c}=e,i=document.createElement(n);(function(e,t,n){const{on:s,...o}=t;s&&(n.listeners=function(e={},t){const n={};return Object.entries(e).forEach(([e,r])=>{const s=function(e,t,n){return n.addEventListener(e,t),t}(e,r,t);n[e]=s}),n}(s,e));r(e,o)})(i,s,e),e.domElement=i,c.forEach(e=>{o(e,i)}),t.appendChild(i)}(t,n);break;case e.FRAGMENT:!function(e,t){const{children:n}=e;e.domElement=t,n.forEach(e=>{o(e,t)})}(t,n);break;default:throw new Error("Unknown fiber type")}}function c(e){return e.filter(e=>null!=e)}function i(t,n={},r=[]){return{type:e.ELEMENT,tag:t,props:n,children:a(c(r))}}function a(t){return t.map(t=>{return"string"==typeof t?(n=t,{type:e.TEXT,value:n}):t;var n})}const u={state:0,reducers:{add:(e,t)=>e+t},view:(e,t)=>i("button",{on:{click:()=>t("add",1)}},[i("p",{},[`You clicked ${e} times.`])])};document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("root");if(null==e)throw new Error("Cannot find root");const{mount:r}=function({state:e,view:r,reducers:s={}}){let c=null,i=null;const a=new n,u=[a.afterEveryCommand(l)];function f(e,t={}){a.dispatch(e,t)}for(const t in s){const n=s[t],r=a.subscribe(t,t=>{e=n(e,t)});u.push(r)}function l(){i&&t(i),i=r(e,f),i&&c&&o(i,c)}return{mount(e){c=e,l()},unmount(){i&&t(i),i=null,u.forEach(e=>e())}}}(u);r(e)});
//# sourceMappingURL=listenjs.js.map
