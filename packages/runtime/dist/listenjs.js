function e(e,n,t,r=null){function o(e){r?n.apply(r):n(e)}return t.addEventListener(e,o),o}var n,t;function r(e){const{type:t}=e;switch(t){case n.TEXT:!function(e){const{domElement:n}=e;n&&n.remove()}(e);break;case n.ELEMENT:!function(e){const{domElement:n,children:t,listeners:o}=e;if(!n)return;n.remove(),t.forEach(r),o&&(!function(e={},n){Object.entries(e).forEach(([e,t])=>{n.removeEventListener(e,t)})}(o,n),delete e.listeners)}(e);break;case n.FRAGMENT:!function(e){const{children:n}=e;n.forEach(r)}(e);break;default:throw new Error("Cannot destroy DOM of type: ",t)}delete e.domElement}!function(e){e[e.TEXT=Node.TEXT_NODE]="TEXT",e[e.ELEMENT=Node.ELEMENT_NODE]="ELEMENT",e[e.FRAGMENT=Node.DOCUMENT_FRAGMENT_NODE]="FRAGMENT"}(n||(n={})),function(e){e.ADD="add",e.REMOVE="remove",e.MOVE="move",e.NOOP="noop"}(t||(t={}));class o{#e=new Map;#n=[];subscribe(e,n){this.#e.has(e)||this.#e.set(e,[]);const t=this.#e.get(e);return t?.includes(n)?()=>{}:(t?.push(n),()=>{if(t){const e=t?.indexOf(n);t?.splice(e,1)}})}afterEveryCommand(e){return this.#n.push(e),()=>{const n=this.#n.indexOf(e);this.#n.splice(n,1)}}dispatch(e,n){this.#e.has(e)?this.#e.get(e)?.forEach(e=>e(n)):console.warn(`No handlers found for command: ${e}`),this.#n.forEach(e=>e())}}function i(e,n){const{class:t,style:r,...o}=n;("string"==typeof t||Array.isArray(t))&&function(e,n){e.className="","string"==typeof n&&(e.className=n);Array.isArray(n)&&e.classList.add(...n)}(e,t),r&&Object.entries(r).forEach(([n,t])=>{"string"==typeof t&&s(e,n,t)});for(const[n,t]of Object.entries(o))"string"==typeof t&&l(e,n,t)}function s(e,n,t){e.style[n]=t}function c(e,n){e.style[n]=null}function l(e,n,t){null==t?a(e,n):n.startsWith("data-")?e.setAttribute(n,String(t)):e[n]=t}function a(e,n){e[n]=null,e.removeAttribute(n)}function d(t,r,o=null,s=null){if(null==r)throw new Error(`\n      "Parent element is not defined: ${r}`);switch(t.type){case n.TEXT:!function(e,n,t){const{value:r}=e,o=document.createTextNode(r);e.domElement=o,u(o,n,t)}(t,r,o);break;case n.ELEMENT:!function(n,t,r,o=null){const{tag:s,props:c,children:l}=n,a=document.createElement(s);(function(n,t,r,o){const{on:s,...c}=t;s&&(r.listeners=function(n={},t,r=null){const o={};return Object.entries(n).forEach(([n,i])=>{const s=e(n,i,t,r);o[n]=s}),o}(s,n,o));i(n,c)})(a,c,n,o),n.domElement=a,l.forEach(e=>{d(e,a,null,o)}),u(a,t,r)}(t,r,o,s);break;case n.FRAGMENT:!function(e,n,t,r=null){const{children:o}=e;e.domElement=n,o.forEach((e,o)=>{d(e,n,t?t+o:null,r)})}(t,r,o,s);break;default:throw new Error("Unknown vNode type")}}function u(e,n,t){if(null==t)return n.appendChild(e);if(t<0)throw new Error(`Position Index must be positive integer, but got ${t}`);const r=n.childNodes;t>=r.length?n.appendChild(e):n.insertBefore(e,r[t])}function f(e){if("children"in e){const t=[];for(const r of e.children)r.type===n.FRAGMENT?t.push(...f(r)):t.push(r);return t}return[]}function m(e,t){if(e.type===t.type&&e.type===n.ELEMENT&&t.type===n.ELEMENT){const{tag:n}=e,{tag:r}=t;return n===r}return!1}function E(e){return e.filter(e=>null!=e)}class h{#t=[];#r=[];#o;constructor(e,n){this.#t=[...e],this.#r=e.map((e,n)=>n),this.#o=n}get length(){return this.#t.length}originalIndexAt(e){return this.#r[e]}findIndexFrom(e,n){for(let t=n;t<this.length;t++)if(this.#o(e,this.#t[t]))return t;return-1}wasElementRemoved(e,n){if(e>=this.length)return!1;const t=this.#t[e];return-1===n.findIndex(e=>this.#o(t,e))}wasElementTheSame(e,n){if(e>=this.length)return!1;const t=this.#t[e],r=n[e];return this.#o(t,r)}wasElementAdded(e,n){return-1===this.findIndexFrom(e,n)}removeItemAction(e){const n={op:t.REMOVE,index:e,item:this.#t[e]};return this.#t.splice(e,1),this.#r.splice(e,1),n}noopItemAction(e){return{op:t.NOOP,originalIndex:this.originalIndexAt(e),index:e,item:this.#t[e]}}addItemAction(e,n){const r={op:t.ADD,index:n,item:e};return this.#t.splice(n,0,e),this.#r.splice(n,0,-1),r}moveItemAction(e,n){const r=this.findIndexFrom(e,n),o={op:t.MOVE,originalIndex:this.originalIndexAt(r),from:r,index:n,item:this.#t[r]},[i]=this.#t.splice(r,1);this.#t.splice(n,0,i);const[s]=this.#r.splice(r,1);return this.#r.splice(n,0,s),o}removeRestItems(e){const n=[];for(;this.length>e;)n.push(this.removeItemAction(e));return n}}function p(e,n){const t=Object.keys(e),r=Object.keys(n);return{added:r.filter(n=>!(n in e)),removed:t.filter(e=>!(e in n)),updated:r.filter(t=>t in e&&e[t]!==n[t])}}function y(e){return function(e){return""!==e}(e.trim())}function v(o,i,u,E=null){if(!m(o,i)){const e=o.domElement?function(e,n){const t=Array.from(e.childNodes).indexOf(n);if(t<0)return null;return t}(u,o.domElement):void 0;return r(o),d(i,u,e,E),i}switch(i.domElement=o.domElement,i.type){case n.TEXT:return o.type===n.TEXT&&function(e,n){if(!e.domElement)throw new Error(`Cannot find DOM Element for old vNode: ${e}`);const t=e.domElement,{value:r}=e,{value:o}=n;r!==o&&(t.nodeValue=o)}(o,i),i;case n.ELEMENT:o.type===n.ELEMENT&&function(n,t,r=null){if(!n.domElement)throw new Error(`Cannot find DOM Element for old vNode: ${n}`);const o=n.domElement,{class:i,style:d,on:u,...f}=n.props,{class:m,style:E,on:h,...v}=t.props,{listeners:g}=n;function T(e,n,t){const{added:r,removed:o,updated:i}=p(n,t);for(const n of o)a(e,n);for(const n of r.concat(i))l(e,n,t[n])}function N(e,n,t){const r=a(n),o=a(t),{added:i,removed:s}=(c=r,{added:(l=o).filter(e=>!c.includes(e)),removed:c.filter(e=>!l.includes(e))});var c,l;function a(e=""){return Array.isArray(e)?e.filter(y):e.split(/(\s+)/).filter(y)}s.length>0&&e.classList.remove(...s),i.length>0&&e.classList.add(...i)}function w(e,n={},t={}){const{added:r,removed:o,updated:i}=p(n,t);for(const n of o)c(e,n);for(const n of r.concat(i))s(e,n,t[n])}function A(n,t={},r={},o={},i=null){const{added:s,removed:c,updated:l}=p(r,o);for(const e of c.concat(l))n.removeEventListener(e,t[e]);const a={};for(const t of s.concat(l))a[t]=e(t,o[t],n,i);return a}T(o,f,v),N(o,i,m),w(o,d,E),t.listeners=A(o,g,u,h,r)}(o,i,E)}return function(e,n,o=null){if(!e.domElement)throw new Error(`Cannot find DOM Element for old vNode: ${e}`);const i=f(e),s=f(n),c=e.domElement,l=function(e,n,t=(e,n)=>e===n){const r=[],o=new h(e,t);for(let e=0;e<n.length;e++){if(o.wasElementRemoved(e,n)){r.push(o.removeItemAction(e)),e--;continue}if(o.wasElementTheSame(e,n)){r.push(o.noopItemAction(e));continue}const t=n[e];o.wasElementAdded(t,e)?r.push(o.addItemAction(t,e)):r.push(o.moveItemAction(t,e))}return r.push(...o.removeRestItems(n.length)),r}(i,s,m);for(const n of l){const{index:l,item:a,op:u}=n,f=o?.offset??0;switch(u){case t.ADD:c instanceof HTMLElement&&d(a,c,l+f,o);break;case t.REMOVE:r(a);break;case t.MOVE:if(c instanceof HTMLElement&&"originalIndex"in n){const t=i[n.originalIndex+f],r=s[l];if(!t.domElement)throw new Error(`Cannot find DOM Element for old vNode: ${e}`);const a=t.domElement,d=c.childNodes[l];c.insertBefore(a,d),v(t,r,c,o)}break;case t.NOOP:c instanceof HTMLElement&&"originalIndex"in n&&v(i[n.originalIndex],s[l],c,o)}}}(o,i,E),i}function g({state:e,view:n,reducers:t={}}){let i=null,s=null;const c=new o,l=[c.afterEveryCommand(function(){const t=n(e,a);s&&i&&(s=v(s,t,i))})];function a(e,n={}){c.dispatch(e,n)}for(const n in t){const r=t[n],o=c.subscribe(n,n=>{e=r(e,n)});l.push(o)}return{mount(t){i=t,s=n(e,a),s&&i&&d(s,i)},unmount(){s&&r(s),s=null,l.forEach(e=>e())}}}function T(e,t={},r=[]){return{type:n.ELEMENT,tag:e,props:t,children:N(E(r))}}function N(e){return e.map(e=>{return"string"==typeof e?(t=e,{type:n.TEXT,value:t}):e;var t})}export{g as createApp,T as createElement};
//# sourceMappingURL=listenjs.js.map
